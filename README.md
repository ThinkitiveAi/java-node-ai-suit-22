# Provider Registration Service

A Spring Boot application for healthcare provider registration with comprehensive validation, security, and testing.

## Features

- **Provider Registration**: Complete registration workflow with validation
- **Password Security**: BCrypt password hashing with 12 salt rounds
- **Input Validation**: Comprehensive validation using JSR-380 (Bean Validation)
- **Custom Password Validation**: Strong password requirements
- **Duplicate Detection**: Prevents duplicate email, phone, and license numbers
- **H2 Database**: In-memory database with console access
- **Comprehensive Testing**: Unit tests for all components
- **Java 17**: Uses Maven toolchains for Java 17 compatibility

## Technology Stack

- **Java 17** (with Maven Toolchains)
- **Spring Boot 3.2.0**
- **Spring Web**
- **Spring Data JPA**
- **Spring Security**
- **H2 Database**
- **Lombok**
- **Hibernate Validator**
- **JUnit 5**

## Prerequisites

- Java 17 (or configure Maven toolchains)
- Maven 3.6+

## Setup

### 1. Clone and Navigate
```bash
cd provider-registration
```

### 2. Build the Project
```bash
mvn clean compile
```

### 3. Run Tests
```bash
mvn test
```

### 4. Run the Application
```bash
mvn spring-boot:run
```

The application will start on `http://localhost:8080`

## API Endpoints

### Provider Registration
- **POST** `/providers/register`
- **Content-Type**: `application/json`

#### Request Body Example:
```json
{
  "firstName": "John",
  "lastName": "Doe",
  "email": "john.doe@example.com",
  "phoneNumber": "+1234567890",
  "password": "StrongPass123!",
  "specialization": "Cardiology",
  "licenseNumber": "LIC123456",
  "yearsOfExperience": 10,
  "clinicAddress": {
    "street": "123 Main St",
    "city": "New York",
    "state": "NY",
    "zip": "10001"
  }
}
```

#### Response Example:
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "firstName": "John",
  "lastName": "Doe",
  "email": "john.doe@example.com",
  "specialization": "Cardiology",
  "verificationStatus": "PENDING",
  "createdAt": "2024-01-15T10:30:00",
  "message": "Provider registered successfully. Verification status: PENDING"
}
```

## Validation Rules

### Password Requirements
- Minimum 8 characters
- At least 1 uppercase letter
- At least 1 lowercase letter
- At least 1 number
- At least 1 special character

### Field Validations
- **First/Last Name**: 2-50 characters, required
- **Email**: Valid email format, unique, required
- **Phone Number**: International format, unique, required
- **Specialization**: 3-100 characters, required
- **License Number**: Alphanumeric only, unique, required
- **Years of Experience**: 0-50, optional
- **Address**: All fields required with specific length limits

## Database

### H2 Console
- **URL**: `http://localhost:8080/h2-console`
- **JDBC URL**: `jdbc:h2:mem:testdb`
- **Username**: `sa`
- **Password**: (empty)

### Schema
The database schema is automatically generated by Hibernate with `ddl-auto=update`.

## Testing

### Run All Tests
```bash
mvn test
```

### Test Coverage
- **StrongPasswordValidator**: Password strength validation
- **ProviderService**: Business logic and duplicate detection
- **ProviderController**: API endpoints and validation

### Test Categories
- Input validation (missing fields, invalid formats)
- Password strength logic
- Duplicate email/phone/license scenarios
- BCrypt password matching
- Input sanitization

## Error Handling

### HTTP Status Codes
- **201 Created**: Successful registration
- **422 Unprocessable Entity**: Validation errors
- **409 Conflict**: Duplicate resources (email, phone, license)

### Error Response Format
```json
{
  "error": "Validation Error",
  "status": 422,
  "fieldErrors": {
    "email": "Email must be a valid email address",
    "password": "Password must be at least 8 characters long..."
  }
}
```

## Security Features

- **Password Hashing**: BCrypt with 12 salt rounds
- **Input Sanitization**: Automatic trimming and case normalization
- **No Plain Text Passwords**: Passwords are never stored or returned in plain text
- **CSRF Protection**: Disabled for API endpoints
- **H2 Console Access**: Configured for development

## Maven Toolchains

The project uses Maven toolchains to ensure Java 17 compatibility without changing system-wide Java settings.

### Toolchains Configuration
If you need to configure toolchains, create `~/.m2/toolchains.xml`:

```xml
<toolchains>
  <toolchain>
    <type>jdk</type>
    <provides>
      <version>17</version>
      <vendor>oracle</vendor>
    </provides>
    <configuration>
      <jdkHome>/path/to/java17</jdkHome>
    </configuration>
  </toolchain>
</toolchains>
```

## Development

### Project Structure
```
src/
├── main/
│   ├── java/com/provider/registration/
│   │   ├── config/           # Configuration classes
│   │   ├── controller/       # REST controllers
│   │   ├── dto/             # Data Transfer Objects
│   │   ├── model/           # JPA entities
│   │   ├── repository/      # Data access layer
│   │   ├── service/         # Business logic
│   │   └── validation/      # Custom validators
│   └── resources/
│       └── application.properties
└── test/
    └── java/com/provider/registration/
        ├── controller/       # Controller tests
        ├── service/         # Service tests
        └── validation/      # Validator tests
```

### Key Classes
- **Provider**: JPA entity with validation annotations
- **ProviderRegistrationRequest**: DTO for registration requests
- **ProviderService**: Business logic implementation
- **ProviderController**: REST API endpoints
- **StrongPasswordValidator**: Custom password validation
- **SecurityConfig**: Spring Security configuration

## Contributing

1. Ensure all tests pass
2. Follow existing code style
3. Add tests for new features
4. Update documentation as needed

## License

This project is for educational purposes.